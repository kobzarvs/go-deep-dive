# String & Rune

String –≤ Go ‚Äî —ç—Ç–æ **immutable –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–π—Ç–æ–≤** (–Ω–µ —Å–∏–º–≤–æ–ª–æ–≤!). –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º —Å—Ç—Ä–æ–∫–∞ —Ö—Ä–∞–Ω–∏—Ç UTF-8 encoded text, –Ω–æ —Å–∞–º–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞–µ—Ç –æ –∫–æ–¥–∏—Ä–æ–≤–∫–µ.

## Memory Layout

```
Stack                          Heap / rodata
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ string header   ‚îÇ            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ            ‚îÇ byte sequence       ‚îÇ
‚îÇ ‚îÇ ptr ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ [0xD0][0x9F][0xD1]..‚îÇ  UTF-8 bytes
‚îÇ ‚îÇ len = 12    ‚îÇ ‚îÇ            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      16 bytes
```

```go
// –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (reflect.StringHeader, deprecated)
// –†–µ–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ runtime/string.go
type stringStruct struct {
    str unsafe.Pointer  // —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±–∞–π—Ç—ã
    len int             // –¥–ª–∏–Ω–∞ –≤ –ë–ê–ô–¢–ê–•
}
```

::: warning len –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–∞–π—Ç—ã, –Ω–µ —Å–∏–º–≤–æ–ª—ã
```go
s := "–ü—Ä–∏–≤–µ—Ç"
len(s)           // 12 (–±–∞–π—Ç), –Ω–µ 6 (—Å–∏–º–≤–æ–ª–æ–≤)
len([]rune(s))   // 6 (—Ä—É–Ω/—Å–∏–º–≤–æ–ª–æ–≤)
```
:::

## UTF-8 Encoding

Go –∏—Å–ø–æ–ª—å–∑—É–µ—Ç UTF-8 ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª–∏–Ω–∞ –æ—Ç 1 –¥–æ 4 –±–∞–π—Ç –Ω–∞ —Å–∏–º–≤–æ–ª:

| –î–∏–∞–ø–∞–∑–æ–Ω Unicode | –ë–∞–π—Ç | –ü—Ä–∏–º–µ—Ä |
|------------------|------|--------|
| U+0000..U+007F | 1 | ASCII: `A` = `0x41` |
| U+0080..U+07FF | 2 | –ö–∏—Ä–∏–ª–ª–∏—Ü–∞: `–ü` = `0xD0 0x9F` |
| U+0800..U+FFFF | 3 | –ö–∏—Ç–∞–π—Å–∫–∏–π: `‰∏≠` = `0xE4 0xB8 0xAD` |
| U+10000..U+10FFFF | 4 | Emoji: `üòÄ` = `0xF0 0x9F 0x98 0x80` |

```go
s := "–ü—Ä–∏–≤–µ—Ç"
fmt.Printf("% x\n", []byte(s))
// d0 9f d1 80 d0 b8 d0 b2 d0 b5 d1 82

// –ö–∞–∂–¥–∞—è –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∞—è –±—É–∫–≤–∞ = 2 –±–∞–π—Ç–∞
// –ü = d0 9f, —Ä = d1 80, –∏ = d0 b8, –≤ = d0 b2, –µ = d0 b5, —Ç = d1 82
```

## –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è: byte vs rune

```go
s := "–ü—Ä–∏–≤–µ—Ç"

// –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ë–ê–ô–¢, –Ω–µ —Ä—É–Ω—É
s[0]  // 0xD0 (–ø–µ—Ä–≤—ã–π –±–∞–π—Ç –±—É–∫–≤—ã "–ü")
s[1]  // 0x9F (–≤—Ç–æ—Ä–æ–π –±–∞–π—Ç –±—É–∫–≤—ã "–ü")

// –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–∏–º–≤–æ–ª, –Ω—É–∂–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
runes := []rune(s)
runes[0]  // '–ü' (1055 –≤ Unicode)
```

## –ò—Ç–µ—Ä–∞—Ü–∏—è: range –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç UTF-8

```go
for i, c := range "–ü—Ä–∏–≤–µ—Ç" {
    fmt.Printf("i=%d c=%c\n", i, c)
}
// i=0  c=–ü
// i=2  c=—Ä    ‚Üê i —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å –Ω–∞ 2 (—Ä–∞–∑–º–µ—Ä –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ä—É–Ω—ã)
// i=4  c=–∏
// i=6  c=–≤
// i=8  c=–µ
// i=10 c=—Ç
```

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** `i` ‚Äî —ç—Ç–æ **byte offset**, –Ω–µ –∏–Ω–¥–µ–∫—Å —Å–∏–º–≤–æ–ª–∞.

```
–°—Ç—Ä–æ–∫–∞ "–ü—Ä–∏–≤–µ—Ç" –≤ –ø–∞–º—è—Ç–∏:

–ë–∞–π—Ç:   0  1  2  3  4  5  6  7  8  9  10 11
       [–ü   ][—Ä   ][–∏   ][–≤   ][–µ   ][—Ç   ]
        ‚Üë     ‚Üë     ‚Üë     ‚Üë     ‚Üë     ‚Üë
i:      0     2     4     6     8     10
c:      –ü     —Ä     –∏     –≤     –µ     —Ç
```

### –ï—Å–ª–∏ –Ω—É–∂–µ–Ω –∏–Ω–¥–µ–∫—Å —Å–∏–º–≤–æ–ª–∞

```go
// –í–∞—Ä–∏–∞–Ω—Ç 1: –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—á—ë—Ç—á–∏–∫
runeIdx := 0
for _, c := range "–ü—Ä–∏–≤–µ—Ç" {
    fmt.Printf("rune %d: %c\n", runeIdx, c)
    runeIdx++
}

// –í–∞—Ä–∏–∞–Ω—Ç 2: –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ []rune
runes := []rune("–ü—Ä–∏–≤–µ—Ç")
for i, c := range runes {
    fmt.Printf("rune %d: %c\n", i, c)  // i ‚Äî –∏–Ω–¥–µ–∫—Å —Å–∏–º–≤–æ–ª–∞
}
```

::: tip –ö–æ–≥–¥–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ []rune
- –ù—É–∂–µ–Ω random access –ø–æ –∏–Ω–¥–µ–∫—Å—É —Å–∏–º–≤–æ–ª–∞
- –ß–∞—Å—Ç—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ `len()` –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ —Å–∏–º–≤–æ–ª–æ–≤
- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤

–ù–æ –ø–æ–º–Ω–∏: `[]rune` —Å–æ–∑–¥–∞—ë—Ç **–Ω–æ–≤—ã–π slice** –∏ **–∫–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ**.
:::

## String Immutability

–°—Ç—Ä–æ–∫–∏ **–Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã**. –õ—é–±–∞—è "–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è" —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É:

```go
s := "hello"
s[0] = 'H'  // ‚ùå –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è

// –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
s = "H" + s[1:]  // –∞–ª–ª–æ–∫–∞—Ü–∏—è –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
```

**–ü–æ—á–µ–º—É immutable:**
1. **Thread-safe** ‚Äî –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –º–µ–∂–¥—É –≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏
2. **Hash stability** ‚Äî —Å—Ç—Ä–æ–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –∫–ª—é—á–∏ map
3. **Compiler optimizations** ‚Äî string literals –≤ read-only –ø–∞–º—è—Ç–∏

## String Concatenation

### –ü—Ä–æ–±–ª–µ–º–∞: O(n¬≤) –ø—Ä–∏ –Ω–∞–∏–≤–Ω–æ–π –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏

```go
// ‚ùå Avoid: –Ω–æ–≤–∞—è –∞–ª–ª–æ–∫–∞—Ü–∏—è –Ω–∞ –ö–ê–ñ–î–û–ô –∏—Ç–µ—Ä–∞—Ü–∏–∏
s := ""
for _, part := range parts {
    s += part  // O(n) –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑
}
// –ò—Ç–æ–≥–æ: O(n¬≤) –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–∞–º—è—Ç–∏
```

```
–ò—Ç–µ—Ä–∞—Ü–∏—è 1: "" + "abc"     ‚Üí alloc "abc" (3 bytes)
–ò—Ç–µ—Ä–∞—Ü–∏—è 2: "abc" + "def"  ‚Üí alloc "abcdef" (6 bytes, –∫–æ–ø–∏—Ä—É–µ–º 3+3)
–ò—Ç–µ—Ä–∞—Ü–∏—è 3: "abcdef" + "ghi" ‚Üí alloc "abcdefghi" (9 bytes, –∫–æ–ø–∏—Ä—É–µ–º 6+3)
...
```

### –†–µ—à–µ–Ω–∏–µ: strings.Builder

```go
// ‚úÖ O(n) ‚Äî amortized append
var b strings.Builder
b.Grow(totalLen)  // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
for _, part := range parts {
    b.WriteString(part)
}
s := b.String()
```

### strings.Builder internals

```go
// strings/builder.go
type Builder struct {
    addr *Builder  // –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
    buf  []byte    // —Ä–∞—Å—Ç—É—â–∏–π –±—É—Ñ–µ—Ä
}

func (b *Builder) WriteString(s string) (int, error) {
    b.buf = append(b.buf, s...)
    return len(s), nil
}

func (b *Builder) String() string {
    // unsafe –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è!
    return unsafe.String(unsafe.SliceData(b.buf), len(b.buf))
}
```

::: tip Zero-copy String()
`Builder.String()` **–Ω–µ –∫–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ** ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç string, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ—Ç –∂–µ –±—É—Ñ–µ—Ä. –ü–æ—ç—Ç–æ–º—É –ø–æ—Å–ª–µ `String()` –Ω–µ–ª—å–∑—è –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø–∏—Å–∞—Ç—å –≤ Builder.
:::

### –ö–æ–≥–¥–∞ –∫–∞–∫–æ–π –º–µ—Ç–æ–¥

| –ú–µ—Ç–æ–¥ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –ê–ª–ª–æ–∫–∞—Ü–∏–∏ |
|-------|-------------------|-----------|
| `+` | 2-3 —Å—Ç—Ä–æ–∫–∏, –∏–∑–≤–µ—Å—Ç–Ω—ã –Ω–∞ compile time | 1 |
| `fmt.Sprintf` | –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ | 1+ |
| `strings.Join` | Slice —Å—Ç—Ä–æ–∫ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º | 1 |
| `strings.Builder` | –¶–∏–∫–ª, –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —á–∏—Å–ª–æ —Å—Ç—Ä–æ–∫ | 1 (—Å Grow) |

```go
// –ü—Ä–æ—Å—Ç–∞—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è ‚Äî OK
full := first + " " + last  // –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç

// Slice —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º
path := strings.Join(parts, "/")

// –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
msg := fmt.Sprintf("User %s (id=%d)", name, id)

// –¶–∏–∫–ª ‚Äî —Ç–æ–ª—å–∫–æ Builder
var b strings.Builder
for _, p := range parts {
    b.WriteString(p)
}
```

## Zero-copy –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

### string ‚Üí []byte (–æ–±—ã—á–Ω–æ –∫–æ–ø–∏—Ä—É–µ—Ç)

```go
s := "hello"
b := []byte(s)  // –∞–ª–ª–æ–∫–∞—Ü–∏—è + –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ 5 –±–∞–π—Ç
```

### –ö–æ–≥–¥–∞ –ù–ï –∫–æ–ø–∏—Ä—É–µ—Ç (compiler optimization)

```go
// 1. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ (Go 1.16+)
if string(byteSlice) == "expected" {
    // string —Å–æ–∑–¥–∞—ë—Ç—Å—è –±–µ–∑ –∞–ª–ª–æ–∫–∞—Ü–∏–∏
}

// 2. Map lookup (Go 1.16+)
m := map[string]int{"key": 42}
_ = m[string(byteSlice)]  // –±–µ–∑ –∞–ª–ª–æ–∫–∞—Ü–∏–∏

// 3. Range over []byte as string
for _, c := range string(byteSlice) {
    // –±–µ–∑ –∞–ª–ª–æ–∫–∞—Ü–∏–∏
}
```

### unsafe –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)

```go
import "unsafe"

// string ‚Üí []byte –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
// ‚ö†Ô∏è DANGER: –Ω–µ–ª—å–∑—è –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç!
func unsafeBytes(s string) []byte {
    return unsafe.Slice(unsafe.StringData(s), len(s))
}

// []byte ‚Üí string –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
// ‚ö†Ô∏è DANGER: –Ω–µ–ª—å–∑—è –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π slice!
func unsafeString(b []byte) string {
    return unsafe.String(unsafe.SliceData(b), len(b))
}
```

::: danger –ö–æ–≥–¥–∞ unsafe –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –ª–æ–º–∞–µ—Ç—Å—è
```go
b := []byte("hello")
s := unsafeString(b)  // s —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ b

b[0] = 'H'  // –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º b
fmt.Println(s)  // "Hello" ‚Äî —Å—Ç—Ä–æ–∫–∞ "–∏–∑–º–µ–Ω–∏–ª–∞—Å—å"!

// –≠—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç immutability
// –∏ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å map, compiler optimizations, etc.
```
:::

## –ü–æ–¥—Å—á—ë—Ç —Å–∏–º–≤–æ–ª–æ–≤

```go
s := "Hello, ‰∏ñÁïå! üéâ"

len(s)                    // 20 (–±–∞–π—Ç)
len([]rune(s))            // 13 (—Ä—É–Ω) ‚Äî –∞–ª–ª–æ–∫–∞—Ü–∏—è!
utf8.RuneCountInString(s) // 13 (—Ä—É–Ω) ‚Äî –±–µ–∑ –∞–ª–ª–æ–∫–∞—Ü–∏–∏ ‚úÖ
```

```go
import "unicode/utf8"

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ UTF-8
utf8.ValidString(s)  // true –µ—Å–ª–∏ –≤–∞–ª–∏–¥–Ω—ã–π UTF-8

// –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–π —Ä—É–Ω—ã
r, size := utf8.DecodeRuneInString(s)
// r = 'H', size = 1

// –î–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
r, size := utf8.DecodeRuneInString("–ü—Ä–∏–≤–µ—Ç")
// r = '–ü', size = 2
```

## String interning

Go **–Ω–µ –¥–µ–ª–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π interning** (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Java). –ö–∞–∂–¥—ã–π `string([]byte{...})` —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É:

```go
a := string([]byte{'h', 'e', 'l', 'l', 'o'})
b := string([]byte{'h', 'e', 'l', 'l', 'o'})
// a –∏ b ‚Äî —Ä–∞–∑–Ω—ã–µ –∞–ª–ª–æ–∫–∞—Ü–∏–∏, —Ö–æ—Ç—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ
```

–ù–æ string literals —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º **—Ä–∞–∑–¥–µ–ª—è—é—Ç –ø–∞–º—è—Ç—å**:

```go
a := "hello"
b := "hello"
// a –∏ b —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –±–∞–π—Ç—ã –≤ rodata
```

## –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### Substring —Å–æ–∑–¥–∞—ë—Ç alias

```go
s := "very long string that takes lots of memory"
prefix := s[:4]  // "very"

// prefix –≤—Å—ë –µ—â—ë —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –í–ï–°–¨ backing array!
// GC –Ω–µ –º–æ–∂–µ—Ç –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –±–æ–ª—å—à—É—é —Å—Ç—Ä–æ–∫—É
```

**–†–µ—à–µ–Ω–∏–µ:** —è–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

```go
prefix := string([]byte(s[:4]))  // –∏–ª–∏ strings.Clone –≤ Go 1.20+
prefix := strings.Clone(s[:4])   // Go 1.20+
```

### Invalid UTF-8

```go
// –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π UTF-8
bad := string([]byte{0xff, 0xfe})

for _, r := range bad {
    fmt.Printf("%U ", r)  // U+FFFD U+FFFD (replacement character)
}
```

Go –∑–∞–º–µ–Ω—è–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ `\uFFFD` (replacement character).

## –§–∞–π–ª—ã runtime/

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| `runtime/string.go` | String operations, concatenation |
| `runtime/utf8.go` | UTF-8 encoding/decoding |
| `strings/builder.go` | strings.Builder implementation |
| `unicode/utf8/utf8.go` | Public UTF-8 API |

## Debugging

```bash
# –ù–∞–π—Ç–∏ string –∞–ª–ª–æ–∫–∞—Ü–∏–∏
go build -gcflags="-m" 2>&1 | grep "string"

# –ë–µ–Ω—á–º–∞—Ä–∫ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏
go test -bench=. -benchmem ./...
```

```go
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å sharing backing storage
import "reflect"

func sharesMemory(a, b string) bool {
    ha := (*reflect.StringHeader)(unsafe.Pointer(&a))
    hb := (*reflect.StringHeader)(unsafe.Pointer(&b))
    return ha.Data == hb.Data
}
```

## –î–∞–ª—å–Ω–µ–π—à–µ–µ —á—Ç–µ–Ω–∏–µ

- [Strings, bytes, runes and characters in Go](https://go.dev/blog/strings) ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –±–ª–æ–≥
- [UTF-8 and Unicode FAQ](https://www.cl.cam.ac.uk/~mgk25/unicode.html) ‚Äî –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- –ò—Å—Ö–æ–¥–Ω–∏–∫–∏: `$GOROOT/src/runtime/string.go`, `unicode/utf8/utf8.go`