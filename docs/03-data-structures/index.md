# Data Structures Deep Dive

Slice, map –∏ string ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ Go-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ—Ç–Ω–∏ —Ä–∞–∑ –≤ –¥–µ–Ω—å. –ù–æ —Å–∫–æ–ª—å–∫–æ –∏–∑ –Ω–∏—Ö –º–æ–≥—É—Ç –æ–±—ä—è—Å–Ω–∏—Ç—å, –ø–æ—á–µ–º—É `append` –∏–Ω–æ–≥–¥–∞ –º—É—Ç–∏—Ä—É–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª, –∞ –∏–Ω–æ–≥–¥–∞ –Ω–µ—Ç? –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –≤–∑—è—Ç—å `&m[key]`? –ò–ª–∏ –ø–æ—á–µ–º—É `len("–ü—Ä–∏–≤–µ—Ç")` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 12, –∞ –Ω–µ 6?

–ü—Ä–æ—Ñ–∞–π–ª–µ—Ä —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –∞–ª–ª–æ–∫–∞—Ü–∏–∏ –Ω–∞ –±–µ–∑–æ–±–∏–¥–Ω–æ–º `append`, slice aliasing bugs –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞—é—Ç –≤ production, –∞ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø–æ–¥—Ö–æ–¥–∞–º–∏ –∫ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫ –º–æ–∂–µ—Ç —Å–æ—Å—Ç–∞–≤–ª—è—Ç—å 10x –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–∏ "–±–∞–∑–æ–≤—ã–µ" —Å—Ç—Ä—É–∫—Ç—É—Ä—ã ‚Äî –æ–¥–Ω–∞ –∏–∑ –≥–ª–∞–≤–Ω—ã—Ö —Å–ª–µ–ø—ã—Ö –∑–æ–Ω Senior —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

## –û–±–∑–æ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö

<InteractiveModal title="Data Structures Overview" icon="üó∫Ô∏è" description="–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö Go">
  <DataStructuresOverview />
</InteractiveModal>

## TL;DR: Memory Layout

| –°—Ç—Ä—É–∫—Ç—É—Ä–∞ | Header | Backing Storage | Pass-by | Mutable | Copy Trigger |
|-----------|--------|-----------------|---------|---------|--------------|
| **slice** | 24 bytes | Heap (backing array) | Value (header) | Elements: Yes | append beyond cap |
| **string** | 16 bytes | Heap or rodata | Value | No (immutable) | Any modification |
| **map** | 8 bytes | Heap (hmap+buckets) | Pointer | Yes | Never (reference) |
| **array** | N √ó sizeof(T) | Stack or Heap | Value (full copy) | Yes | Always on assign |

::: tip –ö–ª—é—á–µ–≤–æ–π –∏–Ω—Å–∞–π—Ç
Slice –∏ string ‚Äî **value types —Å pointer –≤–Ω—É—Ç—Ä–∏**: –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é header –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è, –Ω–æ backing storage –æ—Å—Ç–∞—ë—Ç—Å—è –æ–±—â–∏–º. Map ‚Äî —ç—Ç–æ **pointer type**: –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `m` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ `runtime.hmap`.
:::

## Memory Layout Overview

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         Data Structures Memory Layout                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                                 ‚îÇ
‚îÇ   SLICE (24 bytes header)              STRING (16 bytes header)                 ‚îÇ
‚îÇ   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê              ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê                 ‚îÇ
‚îÇ                                                                                 ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                      ‚îÇ
‚îÇ   ‚îÇ ptr ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ                  ‚îÇ ptr ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ                      ‚îÇ
‚îÇ   ‚îÇ len = 3      ‚îÇ  ‚îÇ                  ‚îÇ len = 12     ‚îÇ  ‚îÇ  (bytes, not runes)  ‚îÇ
‚îÇ   ‚îÇ cap = 8      ‚îÇ  ‚îÇ                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îò                      ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îò                                 ‚îÇ                         ‚îÇ
‚îÇ                  ‚îÇ                                    ‚ñº                         ‚îÇ
‚îÇ                  ‚ñº                     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê             ‚îÇ "–ü—Ä–∏–≤–µ—Ç" (UTF-8)    ‚îÇ (immutable)      ‚îÇ
‚îÇ   ‚îÇ [0] [1] [2] ... [7]  ‚îÇ (mutable)   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                                      ‚îÇ
‚îÇ              Heap                                 Heap / rodata                 ‚îÇ
‚îÇ                                                                                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                                 ‚îÇ
‚îÇ   MAP (8 bytes pointer)                                                         ‚îÇ
‚îÇ   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê                                                         ‚îÇ
‚îÇ                                                                                 ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ   ‚îÇ *hmap ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ hmap                                                ‚îÇ      ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ      ‚îÇ
‚îÇ                    ‚îÇ ‚îÇ count, B, hash0, buckets, oldbuckets, nevacuate‚îÇ  ‚îÇ      ‚îÇ
‚îÇ                    ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ      ‚îÇ
‚îÇ                    ‚îÇ           ‚îÇ                                         ‚îÇ      ‚îÇ
‚îÇ                    ‚îÇ           ‚ñº                                         ‚îÇ      ‚îÇ
‚îÇ                    ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ      ‚îÇ
‚îÇ                    ‚îÇ ‚îÇ buckets: [bucket0][bucket1]...[bucket_2^B]     ‚îÇ ‚îÇ      ‚îÇ
‚îÇ                    ‚îÇ ‚îÇ          ‚îú‚îÄtophash[8]‚îÄ‚î§                         ‚îÇ ‚îÇ      ‚îÇ
‚îÇ                    ‚îÇ ‚îÇ          ‚îú‚îÄkeys[8]‚îÄ‚îÄ‚îÄ‚îÄ‚î§                         ‚îÇ ‚îÇ      ‚îÇ
‚îÇ                    ‚îÇ ‚îÇ          ‚îú‚îÄvalues[8]‚îÄ‚îÄ‚î§                         ‚îÇ ‚îÇ      ‚îÇ
‚îÇ                    ‚îÇ ‚îÇ          ‚îî‚îÄoverflow‚îÄ‚îÄ‚îÄ‚îò                         ‚îÇ ‚îÇ      ‚îÇ
‚îÇ                    ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ      ‚îÇ
‚îÇ                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ                                          Heap                                   ‚îÇ
‚îÇ                                                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã runtime/

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| `runtime/slice.go` | Slice operations, `growslice` |
| `runtime/map.go` | Map operations, `hmap` structure |
| `runtime/map_fast*.go` | Optimized ops –¥–ª—è int32, int64, string |
| `runtime/string.go` | String operations, concatenation |
| `runtime/utf8.go` | UTF-8 encoding/decoding |

## –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã Go 1.25

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| Slice header size | 24 bytes | `ptr` + `len` + `cap` |
| String header size | 16 bytes | `ptr` + `len` |
| Map pointer size | 8 bytes | Pointer to `hmap` |
| Bucket size | 8 k-v pairs | `bucketCnt` –≤ `runtime/map.go` |
| Growth threshold | 256 | –ü–æ—Ä–æ–≥ —Å–º–µ–Ω—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–æ—Å—Ç–∞ slice |
| Map load factor | 6.5 | `loadFactorNum/loadFactorDen` |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–∞

### [Slice Internals](./slice-internals)
24-–±–∞–π—Ç–æ–≤—ã–π header (`ptr`, `len`, `cap`), backing array –Ω–∞ heap, growth strategy (–∏–∑–º–µ–Ω—ë–Ω–Ω–∞—è –≤ Go 1.18). Escape analysis –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è: –∫–æ–≥–¥–∞ slice —Ü–µ–ª–∏–∫–æ–º –Ω–∞ stack. –í–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç–∏ `runtime.growslice`, —Ä–∞—Å—á—ë—Ç –Ω–æ–≤–æ–π capacity.

### [Slice Append](./slice-append)
–°–µ–º–∞–Ω—Ç–∏–∫–∞ `append`: –∫–æ–≥–¥–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π backing array, –∞ –∫–æ–≥–¥–∞ –º—É—Ç–∏—Ä—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π. –ì–ª–∞–≤–Ω–∞—è –ª–æ–≤—É—à–∫–∞ ‚Äî shared array –ø—Ä–∏ `cap > len`. –†–µ—à–µ–Ω–∏—è: `slices.Clone()`, three-index slice `s[low:high:max]`, —è–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ.

### [Map Internals](./map-internals)
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ `hmap`, `bmap` (bucket), overflow chains, evacuation –ø—Ä–∏ load factor ~6.5. –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –≤–∑—è—Ç—å `&m[key]` ‚Äî –Ω–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤. Iteration randomization –∫–∞–∫ –∑–∞—â–∏—Ç–∞ –æ—Ç hash-DoS. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ `map_fast*.go` –¥–ª—è —á–∞—Å—Ç—ã—Ö —Ç–∏–ø–æ–≤ –∫–ª—é—á–µ–π.

### [String & Rune](./string-rune)
Immutable UTF-8 bytes –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º. –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è `s[i]` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç byte, –Ω–µ rune. `range` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç UTF-8. `strings.Builder` –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ `[]byte` ‚Üî `string` –∏ –∫–æ–≥–¥–∞ –æ–Ω–∏ zero-copy.

::: tip Go 1.21+ –ø–∞–∫–µ—Ç—ã slices –∏ maps
```go
// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ shared backing array
dst := slices.Clone(src)

// Pre-allocation –¥–ª—è –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
s := slices.Grow(s, additionalCapacity)

// Deep copy map
m2 := maps.Clone(m1)

// –£—Ç–∏–ª–∏—Ç—ã
keys := maps.Keys(m)
values := maps.Values(m)
```
:::

## Performance Guidelines

### Slice pre-allocation

```go
// ‚ùå Avoid: repeated allocations
var result []Item
for _, x := range data {
    result = append(result, process(x))  // –¥–æ 20+ –∞–ª–ª–æ–∫–∞—Ü–∏–π
}

// ‚úÖ Better: single allocation
result := make([]Item, 0, len(data))
for _, x := range data {
    result = append(result, process(x))  // 0 –∞–ª–ª–æ–∫–∞—Ü–∏–π
}
```

### Map initialization

```go
// ‚ùå Avoid: multiple evacuations
m := make(map[string]int)  // –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä
for i := 0; i < 10000; i++ {
    m[keys[i]] = values[i]  // –Ω–µ—Å–∫–æ–ª—å–∫–æ evacuations
}

// ‚úÖ Better: hint –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
m := make(map[string]int, len(keys))
for i := 0; i < 10000; i++ {
    m[keys[i]] = values[i]  // 0 evacuations
}
```

### String concatenation

```go
// ‚ùå Avoid: O(n¬≤) allocations
s := ""
for _, part := range parts {
    s += part  // –Ω–æ–≤–∞—è –∞–ª–ª–æ–∫–∞—Ü–∏—è –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
}

// ‚úÖ Better: O(n) —Å strings.Builder
var b strings.Builder
b.Grow(totalLen)  // optional pre-allocation
for _, part := range parts {
    b.WriteString(part)
}
s := b.String()
```

### Map iteration with delete

```go
// ‚úÖ Safe: –ø—Ä—è–º–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è –∏—Ç–µ—Ä–∞—Ü–∏–∏
for k, v := range m {
    if shouldDelete(v) {
        delete(m, k)  // –±–µ–∑–æ–ø–∞—Å–Ω–æ –≤ Go
    }
}

// ‚úÖ Alternative: collect-then-delete (clearer intent)
var toDelete []string
for k, v := range m {
    if shouldDelete(v) {
        toDelete = append(toDelete, k)
    }
}
for _, k := range toDelete {
    delete(m, k)
}
```

## Debugging & Tools

```bash
# Escape analysis ‚Äî —á—Ç–æ —É—Ö–æ–¥–∏—Ç –Ω–∞ heap
go build -gcflags="-m -m" ./...

# Memory allocations –≤ –±–µ–Ω—á–º–∞—Ä–∫–∞—Ö
go test -bench=. -benchmem ./...

# Heap profile ‚Äî –≥–¥–µ –∞–ª–ª–æ—Ü–∏—Ä—É–µ—Ç—Å—è –ø–∞–º—è—Ç—å
go tool pprof -alloc_objects http://localhost:6060/debug/pprof/heap

# Bounds check elimination
go build -gcflags="-d=ssa/check_bce/debug=1" ./...

# Assembly output ‚Äî —á—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä
go build -gcflags="-S" ./...
```

::: warning –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

**1. Slice aliasing**
```go
s1 := make([]int, 3, 5)
s2 := append(s1, 4)  // ‚ö†Ô∏è –ø—Ä–∏ cap > len –æ–±–∞ —Å–º–æ—Ç—Ä—è—Ç –Ω–∞ —Ç–æ—Ç –∂–µ –º–∞—Å—Å–∏–≤
s1[0] = 999          // s2[0] —Ç–æ–∂–µ —Å—Ç–∞–Ω–µ—Ç 999!
```

**2. Map nil check**
```go
var m map[string]int
_ = m["key"]         // ‚úÖ OK ‚Äî –≤–µ—Ä–Ω—ë—Ç zero value
m["key"] = 1         // ‚ùå panic: assignment to entry in nil map
```

**3. String iteration**
```go
for i, c := range "–ü—Ä–∏–≤–µ—Ç" {
    // i ‚Äî byte offset (0, 2, 4, 6, 8, 10), –Ω–µ rune index
    // c ‚Äî rune (–ü, —Ä, –∏, –≤, –µ, —Ç)
}
```

**4. Map pointer stability**
```go
m := map[string]Data{"key": {}}
ptr := &m["key"]  // ‚ùå –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è ‚Äî –Ω–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤
m["key"].Field = 1  // ‚ùå –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è ‚Äî –Ω–µ–ª—å–∑—è –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é

// ‚úÖ –†–µ—à–µ–Ω–∏–µ: –∏–∑–≤–ª–µ—á—å, –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å, –∑–∞–ø–∏—Å–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ
d := m["key"]
d.Field = 1
m["key"] = d
```
:::

::: info –°–≤—è–∑—å —Å Runtime
–û–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö —Ç–µ—Å–Ω–æ —Å–≤—è–∑–∞–Ω—ã —Å memory allocator:
- `make([]T, n)` ‚Üí `runtime.makeslice` ‚Üí `mallocgc`
- `make(map[K]V, hint)` ‚Üí `runtime.makemap` ‚Üí bucket allocation
- String literals ‚Üí `rodata` section (–Ω–µ heap)

–°–º. [Stack vs Heap](/01-runtime/stack-heap) –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è escape analysis –∏ –∫–æ–≥–¥–∞ backing array —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ stack.
:::

## –î–∞–ª—å–Ω–µ–π—à–µ–µ —á—Ç–µ–Ω–∏–µ

- [Go Slices: usage and internals](https://go.dev/blog/slices-intro) ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –±–ª–æ–≥
- [Go maps in action](https://go.dev/blog/maps) ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –±–ª–æ–≥
- [Strings, bytes, runes and characters](https://go.dev/blog/strings) ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –±–ª–æ–≥
- –ò—Å—Ö–æ–¥–Ω–∏–∫–∏: `$GOROOT/src/runtime/slice.go`, `map.go`, `string.go`
- [slices package](https://pkg.go.dev/slices) ‚Äî Go 1.21+
- [maps package](https://pkg.go.dev/maps) ‚Äî Go 1.21+
